generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Logs {
  id              Int      @id @default(autoincrement())
  appliedJobId    Int
  changedByUserId Int
  oldData         String   @db.LongText
  newData         String   @db.LongText
  changes         String?  @db.LongText
  changeType      String   @db.VarChar(255)
  createdAt       DateTime @db.DateTime(0)
  updatedAt       DateTime @db.DateTime(0)
}

model Platforms {
  id               Int            @id @default(autoincrement())
  name             String         @db.VarChar(255)
  createdAt        DateTime       @db.DateTime(0)
  updatedAt        DateTime       @db.DateTime(0)
  connect_cost_usd Decimal?       @db.Decimal(10, 2)
  connect_cost_inr Decimal?       @db.Decimal(10, 2)
  applied_jobs     applied_jobs[]
}

model Profiles {
  id        Int      @id @default(autoincrement())
  name      String   @db.VarChar(255)
  createdAt DateTime @db.DateTime(0)
  updatedAt DateTime @db.DateTime(0)
}

model ScrapeLogs {
  id                  Int                   @id @default(autoincrement())
  technologyName      String?               @db.VarChar(100)
  jobCount            Int?
  scrapedAt           DateTime?             @db.DateTime(0)
  createdAt           DateTime              @db.DateTime(0)
  updatedAt           DateTime              @db.DateTime(0)
  TechnologyJobCounts TechnologyJobCounts[]
}

model Technologies {
  id                Int                 @id @default(autoincrement())
  name              String              @unique(map: "name") @db.VarChar(255)
  createdAt         DateTime            @default(now()) @db.Timestamp(0)
  updatedAt         DateTime            @default(now()) @db.Timestamp(0)
  aliases           String?             @db.LongText
  user_technologies user_technologies[]
}

model TechnologyJobCounts {
  id          Int        @id @default(autoincrement())
  scrapeLogId Int
  technology  String     @db.VarChar(255)
  count       Int?       @default(0)
  createdAt   DateTime   @db.DateTime(0)
  updatedAt   DateTime   @db.DateTime(0)
  ScrapeLogs  ScrapeLogs @relation(fields: [scrapeLogId], references: [id], onDelete: NoAction, map: "fk_scrapeLog")

  @@index([scrapeLogId], map: "fk_scrapeLog")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model applied_jobs {
  id                     Int                @id @default(autoincrement())
  bidder_name            String?            @db.VarChar(255)
  profile_name           String?            @db.VarChar(255)
  technologies           String?            @db.Text
  connects_used          Int?
  proposal_link          String?            @db.VarChar(255)
  applied_at             DateTime?          @db.DateTime(0)
  userId                 Int
  jobId                  String             @db.VarChar(255)
  platformId             Int?
  created_at             DateTime           @db.DateTime(0)
  updated_at             DateTime           @db.DateTime(0)
  manual_job_title       String?            @db.VarChar(255)
  manual_job_description String?            @db.Text
  manual_job_url         String?            @db.Text
  profileId              Int?
  stage                  applied_jobs_stage @default(applied)
  replyDate              DateTime?          @db.DateTime(0)
  replyNotes             String?            @db.Text
  interviewDate          DateTime?          @db.DateTime(0)
  interviewNotes         String?            @db.Text
  not_hired_notes        String?            @db.Text
  hired_date             DateTime?          @db.DateTime(0)
  attachments            String?            @db.LongText
  Platforms              Platforms?         @relation(fields: [platformId], references: [id], onDelete: Restrict, onUpdate: Restrict, map: "fk_platform")

  @@index([platformId], map: "fk_platform")
}

model developers {
  developerId String    @id @db.VarChar(255)
  name        String    @db.VarChar(255)
  email       String?   @db.VarChar(255)
  contact     String?   @db.VarChar(255)
  createdAt   DateTime? @default(now()) @db.DateTime(0)
  updatedAt   DateTime? @default(now()) @db.DateTime(0)
  userId      String    @db.VarChar(255)
}

model hired_jobs {
  id           Int                   @id @default(autoincrement())
  jobId        String                @db.VarChar(255)
  bidderId     String?               @db.VarChar(255)
  developerId  String?               @db.VarChar(255)
  hiredAt      DateTime?             @default(now()) @db.DateTime(0)
  notes        String?               @db.Text
  createdAt    DateTime?             @default(now()) @db.DateTime(0)
  updatedAt    DateTime?             @default(now()) @db.DateTime(0)
  budgetType   hired_jobs_budgetType
  clientName   String                @db.VarChar(255)
  profileName  String                @db.VarChar(255)
  budgetAmount Float                 @db.Float
  hired_date   DateTime?             @db.DateTime(0)

  @@index([jobId], map: "jobId")
}

model ignored_jobs {
  id           Int      @id @default(autoincrement())
  reason       String   @db.VarChar(255)
  userId       BigInt   @db.UnsignedBigInt
  jobId        String   @db.VarChar(255)
  createdAt    DateTime @db.DateTime(0)
  updatedAt    DateTime @db.DateTime(0)
  customReason String?  @db.VarChar(255)
  users        users    @relation(fields: [userId], references: [id], onDelete: NoAction, map: "ignored_jobs_ibfk_1")
  jobs         jobs     @relation(fields: [jobId], references: [jobId], onDelete: NoAction, map: "ignored_jobs_ibfk_2")

  @@index([jobId], map: "jobId")
  @@index([userId], map: "userId")
}

model jobs {
  jobId             String         @id @db.VarChar(255)
  title             String?        @db.VarChar(255)
  link              String?        @db.Text
  postedTime        String?        @db.VarChar(255)
  rating            String?        @db.VarChar(255)
  jobType           String?        @db.VarChar(255)
  hourlyRate        String?        @db.VarChar(255)
  fixedPrice        String?        @db.VarChar(255)
  experienceLevel   String?        @db.VarChar(255)
  estimatedDuration String?        @db.VarChar(255)
  shortDescription  String?        @db.Text
  clientSpent       String?        @db.VarChar(255)
  isPaymentVerified Boolean?
  clientLocation    String?        @db.VarChar(255)
  proposals         String?        @db.VarChar(255)
  exactDateTime     String?        @db.VarChar(255)
  techStack         String?        @db.LongText
  selectedTech      String?        @db.VarChar(255)
  created_at        DateTime       @default(now()) @db.DateTime(0)
  updated_at        DateTime       @default(now()) @db.DateTime(0)
  ignoredJobs       Boolean        @default(false)
  appliedJobs       Boolean        @default(false)
  scrapeLogId       String?        @db.VarChar(255)
  hiredJobs         Boolean?       @default(false)
  ignored_jobs      ignored_jobs[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model notifications {
  id        Int                     @id @default(autoincrement())
  userId    BigInt                  @db.UnsignedBigInt
  type      notifications_type
  title     String?                 @db.VarChar(255)
  message   String?                 @db.Text
  metadata  String?                 @db.LongText
  isRead    Boolean?                @default(false)
  priority  notifications_priority? @default(medium)
  actionUrl String?                 @db.VarChar(255)
  icon      String?                 @db.VarChar(100)
  createdAt DateTime?               @db.DateTime(0)
  readAt    DateTime?               @db.DateTime(0)
  users     users                   @relation(fields: [userId], references: [id], onDelete: Cascade, map: "notifications_ibfk_1")

  @@index([createdAt], map: "notifications_created_at")
  @@index([isRead], map: "notifications_is_read")
  @@index([userId], map: "notifications_user_id")
  @@index([userId, isRead], map: "notifications_user_id_is_read")
}

model portfolios {
  id            BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  user_id       BigInt    @db.UnsignedBigInt
  portfolio_url String    @db.VarChar(500)
  technologies  String    @db.LongText
  display_order Int?      @default(0)
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  updated_at    DateTime? @default(now()) @db.Timestamp(0)
  users         users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "portfolios_ibfk_1")

  @@index([user_id], map: "user_id")
}

model user_technologies {
  userId       BigInt       @db.UnsignedBigInt
  technologyId Int
  is_active    Boolean?     @default(true)
  createdAt    DateTime     @db.DateTime(0)
  updatedAt    DateTime     @db.DateTime(0)
  users        users        @relation(fields: [userId], references: [id], onDelete: Cascade, map: "user_technologies_ibfk_1")
  Technologies Technologies @relation(fields: [technologyId], references: [id], onDelete: Cascade, map: "user_technologies_ibfk_2")

  @@id([userId, technologyId])
  @@unique([userId, technologyId], map: "user_technologies_technologyId_userId_unique")
  @@unique([userId, technologyId], map: "user_technologies_user_id_technology_id")
  @@index([technologyId], map: "technologyId")
}

model users {
  id                BigInt              @id @default(autoincrement()) @db.UnsignedBigInt
  email             String              @unique(map: "email") @db.VarChar(255)
  password          String              @db.VarChar(255)
  firstname         String              @db.VarChar(255)
  lastname          String              @db.VarChar(255)
  role              users_role?         @default(user)
  joinDate          DateTime?           @default(now()) @db.DateTime(0)
  lastActive        DateTime?           @db.DateTime(0)
  status            users_status?       @default(active)
  ignored_jobs      ignored_jobs[]
  notifications     notifications[]
  portfolios        portfolios[]
  user_technologies user_technologies[]
}

model weekly_targets {
  id              Int      @id @default(autoincrement())
  userId          Int
  week_start      DateTime @db.Date
  week_end        DateTime @db.Date
  target_amount   Int
  achieved_amount Int
  createdAt       DateTime @db.DateTime(0)
  updatedAt       DateTime @db.DateTime(0)
}

enum notifications_type {
  job_applied
  job_hired
  job_replied
  job_interviewed
  job_rejected
  target_achieved
  target_reminder
  connects_low
  weekly_summary
  new_job_match
  system_alert
  user_blocked
  user_activated
}

enum users_role {
  admin
  user
}

enum notifications_priority {
  low
  medium
  high
  urgent
}

enum users_status {
  active
  blocked
}

enum hired_jobs_budgetType {
  Hourly
  Fixed
}

enum applied_jobs_stage {
  applied
  replied
  interview
  hired
  not_hired @map("not-hired")
}
